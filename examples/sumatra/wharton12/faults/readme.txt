
# reference point
echo 94 2 | proj +proj=utm +zone=47
-56748.29       221910.44

# convert slip model to relax format
awk 'NR>3' chlieh+07.dat | proj +proj=utm +zone=47 | awk 'BEGIN{print "# n      slip         x1         x2        x3 length width strike dip    rake"}{printf "%3.3d %6.3e %10.3e %10.3e %6.3e     %d    %d    %d  %d %7.3f\n",NR,$3/1e2,($2-221910.44)/1e3,($1+56748.29)/1e3,$7,20,16,$5,$6,$4}' > chlieh+07_km.dat

# convert to paraview format
flt2vtk.sh < chlieh+07_km.flt > ../paraview/chlieh+07_km.vtp

# convert S. Wei et al. (2013) convert to m
grep -v "#" S1_slipmodel_m86-1.txt | awk 'NR>5'| proj -r +proj=utm +zone=47 | awk -v W=5 -v L=20 'BEGIN{Pi=3.14159265;print "# nb  slip      x1      x2      x3   length  width strike dip  rake"}{slip=$4/100;rake=$5;str0=$6;dip0=$7;str=str0*Pi/180;dip=dip0/180*Pi;s[1]=cos(str);s[2]=sin(str);s[3]=0;d[1]=sin(str)*cos(dip);d[2]=-cos(str)*cos(dip);d[3]=-sin(dip);x1=($2-221910.44)/1e3-s[1]*L/2+d[1]*W/2;x2=($1+56748.29)/1e3-s[2]*L/2+d[2]*W/2;x3=$3+d[3]*W/2;printf "%3d %6.2f %7.2f %7.2f %7.2f   %6.2f %6.2f    %d   %d %5.1f\n", NR,slip,x1,x2,x3,L,W,str0,dip0,rake}' > swei+13_m1_km.flt
grep -v "#" S1_slipmodel_m86-2.txt | awk 'NR>5'| proj -r +proj=utm +zone=47 | awk -v W=5 -v L=20 'BEGIN{Pi=3.14159265;print "# nb  slip      x1      x2      x3   length  width strike dip  rake"}{slip=$4/100;rake=$5;str0=$6;dip0=$7;str=str0*Pi/180;dip=dip0/180*Pi;s[1]=cos(str);s[2]=sin(str);s[3]=0;d[1]=sin(str)*cos(dip);d[2]=-cos(str)*cos(dip);d[3]=-sin(dip);x1=($2-221910.44)/1e3-s[1]*L/2+d[1]*W/2;x2=($1+56748.29)/1e3-s[2]*L/2+d[2]*W/2;x3=$3+d[3]*W/2;printf "%3d %6.2f %7.2f %7.2f %7.2f   %6.2f %6.2f    %d   %d %5.1f\n", NR+156,slip,x1,x2,x3,L,W,str0,dip0,rake}' >> swei+13_m1_km.flt
grep -v "#" S1_slipmodel_m86-3.txt | awk 'NR>5'| proj -r +proj=utm +zone=47 | awk -v W=5 -v L=20 'BEGIN{Pi=3.14159265;print "# nb  slip      x1      x2      x3   length  width strike dip  rake"}{slip=$4/100;rake=$5;str0=$6;dip0=$7;str=str0*Pi/180;dip=dip0/180*Pi;s[1]=cos(str);s[2]=sin(str);s[3]=0;d[1]=sin(str)*cos(dip);d[2]=-cos(str)*cos(dip);d[3]=-sin(dip);x1=($2-221910.44)/1e3-s[1]*L/2+d[1]*W/2;x2=($1+56748.29)/1e3-s[2]*L/2+d[2]*W/2;x3=$3+d[3]*W/2;printf "%3d %6.2f %7.2f %7.2f %7.2f   %6.2f %6.2f    %d   %d %5.1f\n", NR+416,slip,x1,x2,x3,L,W,str0,dip0,rake}' >> swei+13_m1_km.flt


grep -v "#" S2_slipmodel_m82.txt | awk 'NR>5'| proj -r +proj=utm +zone=47 | awk -v W=5 -v L=10 'BEGIN{Pi=3.14159265;print "# nb  slip      x1      x2      x3   length  width strike dip  rake"}{slip=$4/100;rake=$5;str0=$6;dip0=$7;str=str0*Pi/180;dip=dip0/180*Pi;s[1]=cos(str);s[2]=sin(str);s[3]=0;d[1]=sin(str)*cos(dip);d[2]=-cos(str)*cos(dip);d[3]=-sin(dip);x1=($2-221910.44)/1e3-s[1]*L/2+d[1]*W/2;x2=($1+56748.29)/1e3-s[2]*L/2+d[2]*W/2;x3=$3+d[3]*W/2;printf "%3d %6.2f %7.2f %7.2f %7.2f   %6.2f %6.2f    %d   %d %5.1f\n", NR,slip,x1,x2,x3,L,W,str0,dip0,rake}' > swei+13_m2_km.flt

# convert Han's model of the 2010 Mentawai earthquake to .flt format
grep -v "#" RESULT_out1_12.mat.fort37 | awk '{print $4,$3,$5,$6,$7,$8,$10}' | proj +proj=utm +zone=47 | awk -v W=15 -v L=14.25 'BEGIN{Pi=3.14159265;print "# n   slip      x1      x2      x3   length  width strike  dip  rake"}{slip=$7;rake=$6;str0=$4;dip0=$5;str=str0*Pi/180;dip=dip0/180*Pi;s[1]=cos(str);s[2]=sin(str);s[3]=0;d[1]=sin(str)*cos(dip);d[2]=-cos(str)*cos(dip);d[3]=-sin(dip);x1=($2-221910.44)/1e3-s[1]*L/2+d[1]*W/2;x2=($1+56748.29)/1e3-s[2]*L/2+d[2]*W/2;x3=$3+d[3]*W/2;printf "%3d %6.2f %7.2f %7.2f %7.2f   %6.2f %6.2f    %d %4.2f %5.1f\n", NR,slip,x1,x2,x3,L,W,str0,dip0,rake}' > han+14_km.flt

# http://www.tectonics.caltech.edu/slip_history/2007_s_sumatra/update/static.txt
grep -v "#" static_bengkulu.txt | awk '{c=$2;$2=$1;$1=c;print $0}' | proj +proj=utm +zone=47 | awk -v W=16 -v L=16 'BEGIN{Pi=3.14159265;print "# n   slip      x1      x2      x3   length  width strike dip   rake"}{slip=$4/1e2;rake=$5;str0=$6;dip0=$7;str=str0*Pi/180;dip=dip0/180*Pi;s[1]=cos(str);s[2]=sin(str);s[3]=0;d[1]=sin(str)*cos(dip);d[2]=-cos(str)*cos(dip);d[3]=-sin(dip);x1=($2-221910.44)/1e3-s[1]*L/2+d[1]*W/2;x2=($1+56748.29)/1e3-s[2]*L/2+d[2]*W/2;x3=$3+d[3]*W/2;printf "%3d %6.2f %7.2f %7.2f %7.2f   %6.2f %6.2f    %d   %d %5.1f\n", NR,slip,x1,x2,x3,L,W,str0,dip0,rake}' > konca+08_km.flt
grep -v "#" static_bengkulu.txt | awk '{c=$2;$2=$1;$1=c;print $0}' | proj +proj=utm +zone=47 | awk -v W=16 -v L=16 'BEGIN{Pi=3.14159265;print "# n   slip          x1          x2          x3   length  width strike dip   rake"}{slip=$4/1e2;rake=$5;str0=$6;dip0=$7;str=str0*Pi/180;dip=dip0/180*Pi;s[1]=cos(str);s[2]=sin(str);s[3]=0;d[1]=sin(str)*cos(dip);d[2]=-cos(str)*cos(dip);d[3]=-sin(dip);x1=(($2-221910.44)/1e3-s[1]*L/2+d[1]*W/2)*1e3;x2=(($1+56748.29)/1e3-s[2]*L/2+d[2]*W/2)*1e3;x3=($3+d[3]*W/2)*1e3;printf "%3d %6.2f %11.2f %11.2f %11.2f   %6.2f %6.2f    %d   %d %5.1f\n", NR,slip,x1,x2,x3,L,W,str0,dip0,rake}' > konca+08.flt

# converts Gusman et al. (2010) model from SRCMOD to .flt format
grep -v "#" s2007BENGKU01GUSM.fsp | awk '{$2=$2-0.9;$1=$1-0.36; print $0}' |  proj +proj=utm +zone=47 -r | awk 'BEGIN{Pi=3.14159265;print "# n   slip      x1      x2      x3   length  width strike dip   rake"}{L=$8;W=$9;slip=$6;rake=$7;str0=$10;dip0=$11;str=str0*Pi/180;dip=dip0/180*Pi;s[1]=cos(str);s[2]=sin(str);s[3]=0;d[1]=sin(str)*cos(dip);d[2]=-cos(str)*cos(dip);d[3]=-sin(dip);x1=($2-221910.44)/1e3-s[1]*L/2;x2=($1+56748.29)/1e3-s[2]*L/2;x3=$5;printf "%3d %6.2f %7.2f %7.2f %7.2f   %6.2f %6.2f    %d   %d %5.1f\n", NR,slip,x1,x2,x3,L,W,str0,dip0,rake}' > gusman+10M1_km.flt
grep -v "#" s2007BENGKU02GUSM.fsp | awk '{$2=$2-0.9;$1=$1-0.36; print $0}' |  proj +proj=utm +zone=47 -r | awk 'BEGIN{Pi=3.14159265;print "# n   slip      x1      x2      x3   length  width strike dip   rake"}{L=$8;W=$9;slip=$6;rake=$7;str0=$10;dip0=$11;str=str0*Pi/180;dip=dip0/180*Pi;s[1]=cos(str);s[2]=sin(str);s[3]=0;d[1]=sin(str)*cos(dip);d[2]=-cos(str)*cos(dip);d[3]=-sin(dip);x1=($2-221910.44)/1e3-s[1]*L/2;x2=($1+56748.29)/1e3-s[2]*L/2;x3=$5;printf "%3d %6.2f %7.2f %7.2f %7.2f   %6.2f %6.2f    %d   %d %5.1f\n", NR,slip,x1,x2,x3,L,W,str0,dip0,rake}' > gusman+10M2_km.flt

grep -v "#" s2007BENGKU01GUSM.fsp | awk '{$2=$2-0.9;$1=$1-0.36; print $0}' |  proj +proj=utm +zone=47 -r | awk 'BEGIN{Pi=3.14159265;print "# n   slip          x1         x2           x3     length    width strike dip  rake"}{L=$8;W=$9;slip=$6;rake=$7;str0=$10;dip0=$11;str=str0*Pi/180;dip=dip0/180*Pi;s[1]=cos(str);s[2]=sin(str);s[3]=0;d[1]=sin(str)*cos(dip);d[2]=-cos(str)*cos(dip);d[3]=-sin(dip);x1=($2-221910.44)/1e3-s[1]*L/2;x2=($1+56748.29)/1e3-s[2]*L/2;x3=$5;printf "%3d %6.2f %11.2f %11.2f %11.2f   %6.2f %6.2f    %d   %d %5.1f\n", NR,slip,x1*1e3,x2*1e3,x3*1e3,L*1e3,W*1e3,str0,dip0,rake}' > gusman+10M1.flt
grep -v "#" s2007BENGKU02GUSM.fsp | awk '{$2=$2-0.9;$1=$1-0.36; print $0}' |  proj +proj=utm +zone=47 -r | awk 'BEGIN{Pi=3.14159265;print "# n   slip          x1         x2           x3     length    width strike dip  rake"}{L=$8;W=$9;slip=$6;rake=$7;str0=$10;dip0=$11;str=str0*Pi/180;dip=dip0/180*Pi;s[1]=cos(str);s[2]=sin(str);s[3]=0;d[1]=sin(str)*cos(dip);d[2]=-cos(str)*cos(dip);d[3]=-sin(dip);x1=($2-221910.44)/1e3-s[1]*L/2;x2=($1+56748.29)/1e3-s[2]*L/2;x3=$5;printf "%3d %6.2f %11.2f %11.2f %11.2f   %6.2f %6.2f    %d   %d %5.1f\n", NR,slip,x1*1e3,x2*1e3,x3*1e3,L*1e3,W*1e3,str0,dip0,rake}' > gusman+10M2.flt

# convert Shengji's inversion to the Relax format
grep -v "#" static_out | awk 'NR>5'| proj -r +proj=utm +zone=47 | awk -v W=9 -v L=9 'BEGIN{Pi=3.14159265;print "# nb  slip      x1      x2      x3   length  width strike dip  rake"}{slip=$4/100;rake=$5;str0=$6;dip0=$7;str=str0*Pi/180;dip=dip0/180*Pi;s[1]=cos(str);s[2]=sin(str);s[3]=0;d[1]=sin(str)*cos(dip);d[2]=-cos(str)*cos(dip);d[3]=-sin(dip);x1=($2-221910.44)/1e3-s[1]*L/2+d[1]*W/2;x2=($1+56748.29)/1e3-s[2]*L/2+d[2]*W/2;x3=$3+d[3]*W/2;printf "%3d %6.2f %7.2f %7.2f %7.2f   %6.2f %6.2f    %d   %d %5.1f\n", NR,slip,x1,x2,x3,L,W,str0,dip0,rake}' > wharton16_mw7.9_km.flt

# convert the flt file to kml
flt2kml.sh -x -56748.29 -y 221910.44 -z 47 -s 1000 wharton16_mw7.9_km.flt

